Software security has been growing in importance due to the increasing reliance on computer systems, the Internet, and the popularity of smartphones as well as other devices that constitute the Internet of Things.
In general, there are two categories of approaches to securing a system by reducing its surface of vulnerability, namely \emph{testing} and \emph{verification}. The former
 generates seeds to guarantee that the underlying software works properly under certain scenarios.
 The latter models the system in an abstracted description and proves its preservations of certain properties.
  In this thesis, we will describe our efforts at \emph{greybox fuzz testing} and \emph{type checking based verification} in securing various software.

Firstly, we apply \emph{greybox fuzz testing} (or \emph{fuzzing}) to detect vulnerabilities introduced by erroneous implementation. Our novelty lies in that we facilitate static program analysis to enhance dynamic fuzzing. To fulfill our goal, we build our own greybox fuzzing framework, Fuzzing Orchestration Toolkit (FOT). Compared to other fuzzing tools, FOT is versatile in the functionalities and can be easily configured or extended for different fuzzing purposes. Till now, FOT has integrated multiple state-of-the-art fuzzing techniques and detected 200+ zero-day vulnerabilities in more than 40 world famous projects, among which 51 CVEs have been assigned.
On top of \FOT, we have also innovatively proposed techniques for two specific fuzzing scenarios.

One scenario is the directed greybox fuzzing (DGF) which improves the directedness of executing towards specific target program locations. To emphasize existing challenges in \mbox{directed} fuzzing, we propose \dFOT to feature four desired properties for directedness. With the statically analyzed results on the target program and its target locations, \dFOT applies multiple dynamic strategies for seed prioritization, power scheduling and \mbox{mutation}.
The experimental results on various real-world \mbox{programs} showed that \dFOT significantly outperforms the state-of-the-art greybox fuzzers AFL and AFLGo in reaching target locations and reproducing specific crashes.

The other scenario is enhancing greybox fuzzing on multithreaded programs. Owing to the non-deterministic nature of multithreading, greybox fuzzers usually work poorly because they are inherently incapable of tracking thread-interleavings.
We therefore present \mtfuzz, a novel thread-aware technique which effectively generates multithreading relevant seeds. \mtfuzz relies on a set of thread-aware instrumentation methods consisting of a stratified exploration-oriented instrumentation and two complementary instrumentations. Our experiments on 12 real-world programs showed that \mtfuzz significantly outperforms the state-of-the-art fuzzer AFL in generating high quality seeds, detecting vulnerabilities, and exposing concurrency bugs.

Secondly, we apply \emph{type checking based verification} to detect those vulnerabilities introduced by logic errors. Particularly, we focus on the information leakage vulnerability caused by inter-app communications on an Android system. 
We propose a lightweight security type system that models permission mechanism on Android, where the permissions are assigned statically and facilitated to enforce access control across applications. 
We proved the soundness of the proposed type system in terms of non-interference, with which we are able to prove the absence of information leakage among various apps in an Android system.
 Additionally, we also presented a deterministic type inference algorithm for the underlying type system. 

Finally, based on the two categories of attempts we have made so far, we will briefly discuss the differences of the two applied vulnerability detection approaches in terms of the capability, the practicality, as well as their potential combinations in detecting vulnerabilities for modern software.

