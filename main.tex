\documentclass[12pt, a4paper, oneside]{Thesis} % Paper size, default font size and one-sided paper
%\documentclass[12pt, a4paper, twoside]{Thesis} % Paper size, default font size and one-sided paper

\hypersetup{urlcolor=blue, colorlinks=true} % Colors hyperlinks in blue - change to black if annoying
\title{\ttitle} % Defines the thesis title - don't touch this

\newcommand{\tabitem}{~~\llap{\textbullet}~~}
\newcommand\Vtextvisiblespace[1][.3em]{%
	\mbox{\kern.06em\vrule height.3ex}%
	\vbox{\hrule width#1}%
	\hbox{\vrule height.3ex}}

\usepackage[perpage]{footmisc}
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}
\usepackage{algorithmic}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{wasysym}
\usepackage{arcs}
\usepackage{array}
\usepackage{bm}
\usepackage{color}
\usepackage{diagbox}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{stmaryrd}
\usepackage{subcaption}
\usepackage{tabularx}
\usepackage{threeparttable}
\usepackage{times}
\usepackage{tikz}
\usepackage{yhmath}
\usepackage{cite}
\usepackage{xcolor}
\usepackage{bussproofs}
\usepackage{verbatim}
\usepackage{listings}
\usepackage{lstlinebgrd}
\usepackage{url}
\usepackage{semantic}
\usepackage{pifont}
\usepackage{fixltx2e}
\usepackage{tcolorbox}

\makeatletter
\newcommand{\thickhline}{\noalign {\ifnum 0=`}\fi \hrule height 1pt
    \futurelet \reserved@a \@xhline
}
\newcolumntype{"}{@{\hskip\tabcolsep\vrule width 1pt\hskip\tabcolsep}}
\makeatother


\DeclareFontFamily{OMX}{yhex}{}
\DeclareFontShape{OMX}{yhex}{m}{n}{<->yhcmex10}{}
\DeclareSymbolFont{yhlargesymbols}{OMX}{yhex}{m}{n}
\DeclareMathAccent{\wideparen}{\mathord}{yhlargesymbols}{"F3}

\DeclareMathOperator*{\argminA}{arg\,min}

%item parameter: [leftmargin=*,topsep=0pt,partopsep=0pt]

\newtheorem{corol}{Corollary}
\newtheorem{thm}{Theorem}
\newtheorem{cor}{Corollary}
\newtheorem{lem}{Lemma}
\newtheorem{prop}{Proposition}
\newtheorem{defn}{Definition}
\newtheorem{rem}{Remark}
\newtheorem{prob}{Problem}
\newcommand{\x}{\bm{x}}
\newcommand{\ve}{\bm{v}}
\newcommand{\ac}{\bm{a}}
\newcommand{\s}{\bm{s}}
\newcommand{\R}{\mathbb{R}^{n_0}}
\newcommand{\myname}{{\bf Hongxu Chen}}
\renewcommand{\figurename}{Fig.}
%\makeatletter\@addtoreset{chapter}{part}\makeatother

 \lstset{
        escapechar=\%,
        captionpos=b,
        aboveskip=12pt,
        numbers=left,
tabsize=2,
        commentstyle=\it,
        basicstyle=\footnotesize,
keywordstyle=\color[rgb]{0,0,1},
        commentstyle=\color[rgb]{0,0.6,0}
        language=C,
        morekeywords={info, test, letvar, in, init},
        showspaces=false,
        showstringspaces=false,
        xleftmargin=2em,
        frame=lines,
        framexleftmargin=2.5em
}


\begin{document}

\frontmatter % Use roman page numbering style (i, ii, iii, iv...) for the pre-content pages

\setstretch{1.6} % Line spacing of 1.3

% Define the page headers using the FancyHdr package and set up for one-sided printing
\fancyhead{} % Clears all page headers and footers
%\rhead{\thepage} % Sets the right side header to show the page number
%\lhead{} % Clears the left side page header

\pagestyle{fancy} % Finally, use the "fancy" page style to implement the FancyHdr headers


%\mainmatter
%\fancyhead[RE,LO]{\fancyplain{}{\leftmark}} 	% pagestyle for arabic number pages
%\renewcommand{\chaptermark}[1]{\markboth{\thechapter\ #1}{}}


\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % New command to make the lines in the title page

%----------------------------------------------------------------------------------------
%	additional commands
%----------------------------------------------------------------------------------------
\newcommand*{\todo}[1]{{\footnotesize \textcolor{red}{$\ll$\textsf{TODO #1}$\gg$}}}
%\newcommand*{\todo}[1]{}
\input{cmd-sta}
\input{cmd-fuzz}


% PDF meta-data
\hypersetup{pdftitle={\ttitle}}
\hypersetup{pdfsubject=\subjectname}
\hypersetup{pdfauthor=\authornames}
\hypersetup{pdfkeywords=\keywordnames}

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\maketitle

\clearpage % Start a new page


%----------------------------------------------------------------------------------------
%	ABSTRACT PAGE
%----------------------------------------------------------------------------------------

%\input{chapters/chapter4/obj}

\pagestyle{fancy} % Return the page headers back to the "fancy" style
\rhead{\thepage}
\setcounter{page}{1}

\addtotoc{Abstract} % Add the "Abstract" page entry to the Contents
\lhead{\emph{Abstract}}
\abstract{

\input{abstract}

}

\clearpage % Start a new page
%\cleardoublepage
%-----------------------------------------------

\setstretch{1.5} % Reset the line-spacing to 1.3 for body text (if it has changed)
\lhead{\emph{Statement of Originality}}
\originality{
	%\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
\input{originality}

}

\clearpage % Start a new page
%\cleardoublepage


%-----------------------------------------------

\setstretch{1.5} % Reset the line-spacing to 1.3 for body text (if it has changed)
\lhead{\emph{Supervisor Declaration Statement}}
\supervisorstate{
	%\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
\input{supervisorstate}
}

\clearpage % Start a new page
%\cleardoublepage


%-----------------------------------------------

\setstretch{1.5} % Reset the line-spacing to 1.3 for body text (if it has changed)
\lhead{\emph{Authorship Attribution Statement}}
\authorship{
	%\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
\input{authorshipstate}
}

\clearpage % Start a new page
%\cleardoublepage


%----------------------------------------------------------------------------------------
%	ACKNOWLEDGEMENTS
%----------------------------------------------------------------------------------------

\setstretch{1.5} % Reset the line-spacing to 1.3 for body text (if it has changed)
\lhead{\emph{Acknowledgements}}
\acknowledgements{
	%\addtocontents{toc}{\vspace{1em}} % Add a gap in the Contents, for aesthetics
\input{acknowledge}
}

\clearpage % Start a new page
%\cleardoublepage


%----------------------------------------------------------------------------------------
%	LIST OF CONTENTS/FIGURES/TABLES PAGES
%----------------------------------------------------------------------------------------

%\pagestyle{fancy} % The page style headers have been "empty" all this time, now use the "fancy" headers as defined before to bring them back

\fancyhead[LE,RO]{\thepage}
\fancyhead[RE,LO]{\fancyplain{}{\emph{Contents}}}  % Set the left side page header to "Contents"
\tableofcontents % Write out the Table of Contents

\fancyhead[LE,RO]{\thepage}
\fancyhead[RE,LO]{\fancyplain{}{\emph{List of Figures}}}
\listoffigures % Write out the List of Figures

\fancyhead[LE,RO]{\thepage}
\fancyhead[RE,LO]{\fancyplain{}{\emph{List of Tables}}}
\listoftables % Write out the List of Tables

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - CHAPTERS
%----------------------------------------------------------------------------------------
%\mainmatter % Begin numeric (1,2,3...) page numbering

\pagestyle{fancy} % Return the page headers back to the "fancy" style
\fancyhead{}
\mainmatter
\fancyhead[LE,RO]{\thepage}
\fancyhead[RE,LO]{\fancyplain{}{\leftmark}} 	% pagestyle for arabic number pages
%\renewcommand{\chaptermark}[1]{\markboth{\thechapter\ #1}{}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{#1}}{}}


% Include the chapters of the thesis as separate files from the Chapters folder
% Uncomment the lines as you write the chapters
\sloppy

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Introduction}}{}}
\input{chapters/intro}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Preliminaries}}{}}
\input{chapters/background}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Related Work}}{}}
\input{chapters/related}

%\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
%\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Vulnerability Detection Techniques}}{}}
%\input{chapters/overall}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{The FOT Fuzzing Framework}}{}}
\input{chapters/fot}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{\dFOT: Directed Grey-box Fuzzing}}{}}
\input{chapters/dfot}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{\mtfuzz: Multi-threading Aware Fuzzing}}{}}
\input{chapters/mtfuzz}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Security Type Checking for Android Access Control}}{}}
\input{chapters/sta}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Hybrid Approach to Distributed Motion Control}}{}}
\input{chapters/discuss}

\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{Conclusion and Future Work}}{}}
\input{conclusion}


\nocite{*}

%----------------------------------------------------------------------------------------
%	THESIS CONTENT - APPENDICES
%----------------------------------------------------------------------------------------

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics
\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
\renewcommand{\chaptermark}[1]{\markboth{Appendix. \emph{List of Publications}}{}}

\appendix % Cue to tell LaTeX that the following 'chapters' are Appendices

%% Include the appendices of the thesis as separate files from the Appendices folder
%% Uncomment the lines as you write the Appendices
%\fancyhead[RE,LO]{\fancyplain{}{\leftmark}}
%\renewcommand{\chaptermark}[1]{\markboth{\chaptername\ \thechapter.\ \emph{List of Publications}}{}}
\input{Appendices/AppendixA}
\input{Appendices/AppendixB}
%\input{Appendices/AppendixC}

\addtocontents{toc}{\vspace{2em}} % Add a gap in the Contents, for aesthetics

\backmatter

%----------------------------------------------------------------------------------------
%	BIBLIOGRAPHY
%----------------------------------------------------------------------------------------
\fancyhead[RE,LO]{\fancyplain{}{\emph{Bibliography}}}

%\label{Bibliography}

%\lhead{\emph{Bibliography}} % Change the page header to say "Bibliography"

\bibliographystyle{IEEEtran}
\bibliography{common,ref-sta,ref-sta-impl,ref-fuzzing}



%\bibliographystyle{unsrtnat} % Use the "unsrtnat" BibTeX style for formatting the Bibliography
%
%\bibliography{Bibliography} % The references (bibliography) information are stored in the file named "Bibliography.bib"
\cleardoublepage

\end{document}
